---
layout: post
title:  "TIL(20240613) [Spring AOP]"
date:  2024-06-13
categories: TIL Spring
---

---------------------------------------------------------------------

# ğŸ“Œ Spring

âœ¨ ë“¤ì–´ê°€ê¸°ì „
- ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¡œì§ì€ í¬ê²Œ **í•µì‹¬ê¸°ëŠ¥/ë¶€ê°€ê¸°ëŠ¥**ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì§
    1) í•µì‹¬ê¸°ëŠ¥(ì¢…ë‹¨ê´€ì‹¬ì‚¬): í•´ë‹¹ ê°ì²´ê°€ ì œê³µí•˜ëŠ” ê³ ìœ ì˜ ê¸°ëŠ¥ 
    2) ë¶€ê°€ê¸°ëŠ¥(íš¡ë‹¨ê´€ì‹¬ì‚¬): í•µì‹¬ê¸°ëŠ¥ì„ ë³´ì¡°í•˜ëŠ” ê¸°ëŠ¥
  


## ğŸ’¡ AOP ë€?

- AOPëŠ” Aspect Oriented Programmingì˜ ì•½ìë¡œ ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ê´€ì ì§€í–¥ì´ë€ ì–´ë–¤ ë¡œì§ì„ ê¸°ì¤€ìœ¼ë¡œ í•µì‹¬ì ì¸ ê´€ì , ë¶€ê°€ì ì¸ ê´€ì ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ë³´ê³  ê·¸ ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ê°ê° ëª¨ë“ˆí™” í•˜ê² ë‹¤ë¼ëŠ” ì˜ë¯¸ì´ë‹¤.

      âœ”ëª¨ë“ˆí™”ë€ ì–´ë–¤ ê³µí†µëœ ë¡œì§ì´ë‚˜ ê¸°ëŠ¥ì„ í•˜ë‚˜ì˜ ë‹¨ìœ„ë¡œ ë¬¶ëŠ” ê²ƒ

- AOPì—ì„œ ê° ê´€ì ì„ ê¸°ì¤€ìœ¼ë¡œ ë¡œì§ì„ ëª¨ë“ˆí™” í•œë‹¤ëŠ” ê²ƒì€ ì½”ë“œë“¤ì„ ë¶€ë¶„ì ìœ¼ë¡œ ë‚˜ëˆ„ì–´ì„œ ë¬¶ê² ë‹¤ ë¼ëŠ” ê²ƒì¸ë°, ì´ë•Œ ì½”ë“œìƒì—ì„œ ë‹¤ë¥¸ ë¶€ë¶„ì—ì„œ ê³„ì† ë°˜ë³µí•´ì„œ ì“°ì´ëŠ” ì½”ë“œë“¤ì„ "í©ì–´ì§„ ê´€ì‹¬ì‚¬"ë¼ê³  ë¶€ë¥¸ë‹¤ê³  í•œë‹¤. ì´ëŸ¬í•œ í©ì–´ì§„ ê´€ì‹¬ì‚¬ë¥¼ Aspectë¡œ ëª¨ë“ˆí™”(ë¬¶ì–´ì„œ)í•˜ì—¬ í•µì‹¬ì ì¸ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ê³¼ëŠ” ë¶„ë¦¬í•˜ì—¬ ê³µí†µëœ ë¡œì§ì€ ì¬ì‚¬ìš©í•˜ê² ë‹¤ëŠ” AOPì˜ ì·¨ì§€ì´ë‹¤.

- ì¦‰, AOPëŠ”Â ë¶€ê°€ ê¸°ëŠ¥ì„ í•µì‹¬ ê¸°ëŠ¥ì—ì„œ ë¶„ë¦¬í•´ í•œ ê³³ìœ¼ë¡œ ê´€ë¦¬í•˜ë„ë¡ í•˜ê³ , ì´ ë¶€ê°€ ê¸°ëŠ¥ì„ ì–´ë””ì— ì ìš©í• ì§€ ì„ íƒí•˜ëŠ” ê¸°ëŠ¥ì„ í•©í•œ í•˜ë‚˜ì˜ ëª¨ë“ˆì´ë‹¤. 


```java

AOP ì£¼ìš” ê°œë…

Aspect : joingPoint+Advice ê²°í•©í•œ ê°ì²´ë¥¼ ì˜ë¯¸í•¨, ìœ„ì—ì„œ ì„¤ëª…í•œ í©ì–´ì§„ ê´€ì‹¬ì‚¬ë¥¼ ëª¨ë“ˆí™” í•œ ê²ƒ. ì£¼ë¡œ ë¶€ê°€ê¸°ëŠ¥ì„ ëª¨ë“ˆí™”í•¨.
Target : Aspectë¥¼ ì ìš©í•˜ëŠ” ê³³ (í´ë˜ìŠ¤, ë©”ì„œë“œ .. )
Advice : ì‹¤ì œ êµ¬í˜„ì²´, ì‹¤ì§ˆì ìœ¼ë¡œ ì–´ë–¤ ì¼ì„ í•´ì•¼í•  ì§€ì— ëŒ€í•œ ê²ƒ, ì‹¤ì§ˆì ì¸ ë¶€ê°€ê¸°ëŠ¥ì„ ë‹´ì€ êµ¬í˜„ì²´
JointPoint : ìˆ˜í–‰ë  ì‹œì , Adviceê°€ ì ìš©ë  ìœ„ì¹˜, ë¼ì–´ë“¤ ìˆ˜ ìˆëŠ” ì§€ì . ë©”ì„œë“œ ì§„ì… ì§€ì , ìƒì„±ì í˜¸ì¶œ ì‹œì , í•„ë“œì—ì„œ ê°’ì„ êº¼ë‚´ì˜¬ ë•Œ ë“± ë‹¤ì–‘í•œ ì‹œì ì— ì ìš©ê°€ëŠ¥
PointCut : ìˆ˜í–‰í•  ëŒ€ìƒ, JointPointì˜ ìƒì„¸í•œ ìŠ¤í™ì„ ì •ì˜í•œ ê²ƒ. 'Aë€ ë©”ì„œë“œì˜ ì§„ì… ì‹œì ì— í˜¸ì¶œí•  ê²ƒ'ê³¼ ê°™ì´ ë”ìš± êµ¬ì²´ì ìœ¼ë¡œ Adviceê°€ ì‹¤í–‰ë  ì§€ì ì„ ì •í•  ìˆ˜ ìˆìŒ

```

[Spring ìŠ¤í”„ë§ AOP (Spring AOP) ì´ì •ë¦¬](https://engkimbs.tistory.com/entry/ìŠ¤í”„ë§AOP)


### ğŸ’¡ ê·¸ë˜ì„œ AOPì˜ ì‚¬ìš©ëª©ì ì€?

- ì½”ë“œë¥¼ ì‘ì„±í•˜ë‹¤ë³´ë©´ ë°˜ë³µì ì´ë©´ì„œ ê¸¸ì´ë§Œ ì°¨ì§€í•˜ëŠ” ì½”ë“œë“¤ì´ ë§ì´ ìˆë‹¤. ì´ëŸ° ê²ƒë“¤ì„ **ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì½”ë“œ**ë¼ê³  í•˜ëŠ”ë°, (JDBCì—ì„œ í”íˆ ë°œê²¬ëœë‹¤.) ì´ëŸ¬í•œ ë¶€ë¶„ë“¤ì„ ë¶€ê°€ê¸°ëŠ¥ AOPë¡œ ì²˜ë¦¬í•˜ì—¬ í•µì‹¬ë¡œì§ì—ì„œ ë¶„ë¦¬ì‹œí‚¤ëŠ” ê²ƒì„ ë§í•œë‹¤. 

```java
// ì• ë„ˆí…Œì´ì…˜ ì¢…ë¥˜

@Aspect	ì´ Classê°€ íš¡ë‹¨ ê´€ì‹¬ì‚¬ ë¡œì§ì„ ëª¨ë“ˆí™”í•œ ê°ì²´(Aspect)ë¼ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” Annotation
@Pointcut	íš¡ë‹¨ ê´€ì‹¬ì‚¬ê°€ ì ìš©ë  JoinPointë“¤ì„ í‘œí˜„ì‹ìœ¼ë¡œ ì •ì˜í•œ ê²ƒ
@Before	Method ê°€ í˜¸ì¶œë˜ê¸° ì „ì— ì‹¤í–‰ë˜ëŠ” Advice ê¸°ëŠ¥ ìˆ˜í–‰
@Around	Method ì‹¤í–‰ ì¤‘ì— í˜¸ì¶œ ì „í›„ì— ì–´ë“œë°”ì´ìŠ¤ ê¸°ëŠ¥ì„ ìˆ˜í–‰
@After	Methodì˜ ê²°ê³¼ì— ê´€ê³„ ì—†ì´(ì„±ê³µ, ì˜ˆì™¸ ê´€ë ¨ì—†ì´. ë§ˆì¹˜ finally ê°™ì€ ê°œë…) íƒ€ê²Ÿ ë©”ì†Œë“œê°€ ì™„ë£Œë˜ë©´ ì–´ë“œë°”ì´ìŠ¤ ê¸°ëŠ¥ì„ ìˆ˜í–‰
@AfterReturning	Methodê°€ ì„±ê³µì ìœ¼ë¡œ ê²°ê³¼ ê°’ì„ ë°˜í™˜í•œ í›„ Advice ê¸°ëŠ¥ ìˆ˜í–‰
@AfterThrowing	Methodê°€ ìˆ˜í–‰ ì¤‘ ì˜ˆì™¸ë¥¼ ë˜ì§€ê²Œ ë˜ë©´ Advice ê¸°ëŠ¥ ìˆ˜í–‰

```

[[Spring] ìŠ¤í”„ë§ AOP](https://hstory0208.tistory.com/entry/Spring-%EC%8A%A4%ED%94%84%EB%A7%81-AOPAspect-Oriented-Programming%EB%9E%80-Aspect)

### ğŸ’¡ ê·¸ë˜ì„œ Spring AOPì˜ ì™œ ì‚¬ìš©í•˜ëŠ” ê²ƒì¸ê°€? 

1) ì½”ë“œì˜ ê°€ë…ì„±ì„ ë†’ì¸ë‹¤. 
2) ì¤‘ë³µì½”ë“œë¥¼ ì¤„ì¸ë‹¤.
3) ìœ ì§€ë³´ìˆ˜ê°€ ì¢‹ë‹¤. -> ë§Œì•½ AOPë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš° ë¶€ê°€ê¸°ëŠ¥ì— ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ëª¨ë“  í´ë˜ìŠ¤ì—ì„œ ë‹¤ ìˆ˜ì •í•´ì¤˜ì•¼í•œë‹¤... 


### ğŸ’¡ AOP ì¶”ê°€í•˜ê¸°

- ëª¨ë“  API(Controller)ê°€ í˜¸ì¶œë  ë•Œ, Request ì •ë³´(Request URL, HTTP Method)ë¥¼ **@Slf4J Logback** ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼  í™œìš©í•˜ì—¬ Logë¡œ ì¶œë ¥í•´ì£¼ì„¸ìš”.
- ì»¨íŠ¸ë¡¤ëŸ¬ ë§ˆë‹¤ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ, AOPë¡œ êµ¬í˜„í•´ì•¼ë§Œ í•©ë‹ˆë‹¤.


```java

@Slf4j
@Aspect
@Component
public class ControllerAop {

  @Before("execution(* com.sparta.reviewspotproject.controller.*Controller.*(..))")
  
  public void logBefore(JoinPoint joinPoint) {
    ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
    HttpServletRequest request = attributes.getRequest();

    log.info("Request URL : {}", request.getRequestURL());
    log.info("HTTP Method : {}", request.getMethod());

  }
}


```








