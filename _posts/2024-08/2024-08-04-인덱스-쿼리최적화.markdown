---
layout: post
title:  "TIL(20240804) [인덱스-쿼리최적화]"
date:  2024-08-04
categories: TIL 쿼리최적화
---

----------------------------------------------------------------------------

## 💡 쿼리 최적화란 무엇이며 방법은 어떤 것이 있을까?
- 쿼리최적화는 데이터베이스 성능을 향상시키기 위해 SQL 쿼리를 최적화하는 과정으로 쿼리 실행 시간을 줄이고, 시스템 자원을 효율적으로 사용하여 데이터베이스의 응답성을 높이는 역할을 한다.

- SQL 쿼리문 최적화 목표
1. 성능 향상(개선)
2. 응답 시간 단축
3. 기술 자원 보존
4. 비용 절약
이라 할 수 있다. 
 
- 쿼리 최적화 방법은

1) 적절한 인덱스 사용: 자주 조회되는 컬럼에 인덱스를 생성하여 검색 속도를 향상시킨다.

```
-- 인덱스 생성
CREATE INDEX idx_customer_name ON customers(name);
```

2) 쿼리 리팩토링: 복잡한 쿼리를 여러 개의 단순한 쿼리로 분할하여 성능을 향상시킨다. (서브쿼리 최적화, 불필요한 컬럼 제거-> SELECT문에서 불필요한 컬럼 제거)

```
-- 서브쿼리 최적화
-- Before
SELECT * FROM orders WHERE customer_id IN (SELECT id FROM customers WHERE name = 'John Doe');

-- After
SELECT o.* FROM orders o JOIN customers c ON o.customer_id = c.id WHERE c.name = 'John Doe';
```
3) 조인 최적화: 일반적으로 작은 테이블을 먼저 조인하는 것이 효율적, 조인 조건을 명확히 해서 불필요한 테이터 스캔 줄이기

4) 쿼리 실행 계획 분석: 데이터베이스가 쿼리를 어떻게 실행하는지 확인하여 실행 계획 분석 후 인덱스를 사용하거나 조인순서, 필터링 조건을 최적화 한다.

-> 아래부분은 좀 더 공부가 필요함

5) 데이터베이스 설정 최적화:** 데이터베이스 캐시 크기를 조정하여 더 많은 데이터를 메모리에 저장하고, 디스크 I/O를 줄이거나 큰 테이블을 파티셔닝하여 쿼리 성능을 향상시킨다. 예를 들어, 날짜 기준으로 데이터를 파티셔닝할 수 있다.

6) 통계 정보 업데이트:** 데이터베이스의 통계 정보를 주기적으로 업데이트하여 쿼리 최적화 도구가 최신 정보를 바탕으로 최적화할 수 있도록 한다.


--JPA 관련 쿼리 최적화 주의사항--
[JPA 성능 개선팁](https://jiwondev.tistory.com/252)

[mySQL워크벤치를 활용한 성능테스트방법](https://2021-pick-git.github.io/service-performance-with-optimizer/)

--SQL관련 쿼리최적화--
        
[SQL 쿼리 성능 최적화를 위한 튜닝 팁 6가지](https://community.heartcount.io/ko/query-optimization-tips/)

[쿼리 최적화: 빠른 쿼리를 위한 7가지 체크리스트](https://medium.com/watcha/%EC%BF%BC%EB%A6%AC-%EC%B5%9C%EC%A0%81%ED%99%94-%EC%B2%AB%EA%B1%B8%EC%9D%8C-%EB%B3%B4%EB%8B%A4-%EB%B9%A0%EB%A5%B8-%EC%BF%BC%EB%A6%AC%EB%A5%BC-%EC%9C%84%ED%95%9C-7%EA%B0%80%EC%A7%80-%EC%B2%B4%ED%81%AC-%EB%A6%AC%EC%8A%A4%ED%8A%B8-bafec9d2c073)


## 💡 DB 로직 최소화를 하려면 어떻게 해야 할까요?