---
layout: post
title:  "TIL(20240706) [Docker? CI/CD?]"
date:  2024-07-06
categories: TIL docker CI/CD
---

----------------------------------------------------------------------------

ë“œë””ì–´ ë°°í¬í•˜ëŠ” ë²•ì„ ë°°ìš°ê²Œ ë˜ëŠ”êµ¬ë‚˜...!!!! ğŸ¤£
ì•„ì§ AWSì— ëŒ€í•´ì„œ ì™„ë²½íˆ ì´í•´í•œ ê±´ ì•„ë‹ˆì§€ë§Œ ë°˜ë³µí•™ìŠµì„ í†µí•´ ìì—°ìŠ¤ëŸ½ê²Œ.. ìµìˆ™í•´ì§€ë ¤ê³  í•œë‹¤. dockerë˜í•œ ê·¸ë ‡ë‹¤!

CI/CDê°€ ë¬´ì—‡ì¸ì§€ ë¨¼ì € ì•Œì•„ë³¸ ë‹¤ìŒì— dockerì˜ ê°œë… ë° ì„¤ì¹˜ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤.

# ğŸ“Œ CI/CD ?
- CI(ì§€ì†ì  í†µí•©): ê°œë°œìë¥¼ ìœ„í•œ ìë™í™” í”„ë¡œì„¸ìŠ¤ë¼ê³  ë³¼ ìˆ˜ ìˆìœ¼ë©°, Code-Build-Test ë‹¨ê³„ì—ì„œ ê¾€í•  ìˆ˜ ìˆë‹¤.

```
code : ê°œë°œìê°€ ì½”ë“œë¥¼ ì›ê²© ì½”ë“œ ì €ì¥ì†Œì— pushí•˜ëŠ” ë‹¨ê³„
build : ì›ê²© ì½”ë“œ ì €ì¥ì†Œë¡œë¶€í„° ì½”ë“œë¥¼ ê°€ì ¸ì™€ ìœ ë‹›í…ŒìŠ¤íŠ¸ í›„ ë¹Œë“œí•˜ëŠ” ë‹¨ê³„
test : ì½”ë“œ ë¹Œë“œ ê²°ê³¼ë¬¼ì´ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì™€ ì˜ í†µí•©ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •
```
- CD(ì§€ì†ì  ë°°í¬): ì§€ì†ì ì¸ ì„œë¹„ìŠ¤ì œê³µ ë° ì§€ì†ì ì¸ ë°°í¬ë¥¼ ì˜ë¯¸í•˜ë©° ì´ ë‘ ìš©ì–´ëŠ” ìƒí˜¸ êµí™˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ê³ , Release-Deploy-Operateë‹¨ê³„ì—ì„œ ê¾€í•  ìˆ˜ ìˆë‹¤.

```
release: ë°°í¬ ê°€ëŠ¥í•œ ì†Œí”„íŠ¸ì›¨ì–´ íŒ¨í‚¤ì§€ ì‘ì„±
deploy: í”„ë¡œë¹„ì €ë‹ì„ ì‹¤í–‰í•˜ê³  ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©ìì—ê²Œ ë…¸ì¶œ-> ì‹¤ì§ˆì ì¸ ë°°í¬
Operate: ì„œë¹„ìŠ¤ í˜„í™©ì„ íŒŒì•…í•˜ê³  ìƒê¸¸ ìˆ˜ ìˆëŠ” ë¬¸ì œë¥¼ ê°ì§€
```

- ì¦‰ CI/CD ëŠ” ì½”ë“œì‘ì„±->ë¹Œë“œ-> í…ŒìŠ¤íŠ¸-> ë°°í¬ì˜ ê³¼ì •ì„ ê°€ì§„ë‹¤. 

```
1. ì½”ë“œ ì‘ì„±: ê°œë°œìë“¤ì€ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  ì €ì¥ì†Œ(repository)ì— ì—…ë¡œë“œ
2. ë¹Œë“œ: ì €ì¥ì†Œì—ì„œ ìµœì‹  ì†ŒìŠ¤ ì½”ë“œë¥¼ ê°€ì ¸ì™€ ë¹Œë“œë¥¼ ìˆ˜í–‰. ë¹Œë“œëŠ” ì†ŒìŠ¤ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ê³ , ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ê³ , í•„ìš”í•œ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ê³¼ì •.
3. í…ŒìŠ¤íŠ¸: ë¹Œë“œëœ ê²°ê³¼ë¬¼ì„ ëŒ€ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰. í…ŒìŠ¤íŠ¸ëŠ” ê¸°ëŠ¥ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ê³ , ë²„ê·¸ë¥¼ ë°œê²¬í•˜ê³  ìˆ˜ì •í•˜ëŠ” ê³¼ì •.
4. ë°°í¬: í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•œ ê²°ê³¼ë¬¼ì„ ë°°í¬. ë°°í¬ëŠ” ì„œë²„ì— ì—…ë¡œë“œí•˜ê±°ë‚˜, ì‚¬ìš©ìì—ê²Œ ì œê³µí•˜ëŠ” ê³¼ì •
```

## ğŸ“Œ Dockerë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”? 
- ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì—¬ëŸ¬ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„¤ì¹˜í•´ë„ í˜¸ìŠ¤íŠ¸ OSì—ëŠ” ì˜í–¥ì´ ì—†ë‹¤. 
- ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œê³¼ ë°°í¬ê°€ í¸í•´ì§„ë‹¤.
- CI/CDì—ì„œ ì§€ì†ì ì¸ í†µí•©ê³¼ì •ì˜ í…ŒìŠ¤íŠ¸ì—ì„œ dockerë¥¼ í™œìš©í•œë‹¤.
- ì–´ë–¤ ì„œë²„ì— ì˜¬ë¦¬ë”ë¼ë„ ê°™ì€ í™˜ê²½ìœ¼ë¡œ êµ¬ì„±ëœ ì»¨í…Œì´ë„ˆë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— í‘œì¤€í™”ëœ ë°°í¬ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.
- ì—¬ëŸ¬ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë…ë¦½ì„±ê³¼ í™•ì¥ì„±ì´ ë†’ì•„ì§„ë‹¤.


### âœ¨ docker ì„¤ì¹˜

ë‹¨ì¶•í‚¤ **Win + X : powershell(ê´€ë¦¬ì)**

ë„ì»¤ë¥¼ ì„¤ì¹˜í•˜ëŠ”ë° í—˜ë‚œí•œ ì—¬ì •ì´ ë˜ì—ˆë‹¤...........
WSLì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ì„œ powershellì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•˜ë‹ˆ

ì €ì˜ ì»´í“¨í„°ëŠ” Window10ì…ë‹ˆë‹¤ğŸ˜… (ã… ã… ê¼¬ë¬¼..)

1. WSL2 ì„¤ì¹˜ë¥¼ ìœ„í•œ ì‚¬ì „ì¤€ë¹„

![image](https://github.com/HaejungHan/HaejungHan.github.io/assets/130989670/3f47b842-ccb0-4c57-a0f0-409f7fe12348)

ë‚˜ëŠ” ì—¬ê¸°ì„œ Hyper_Vê¹Œì§€ ì²´í¬í•´ì£¼ì—ˆë‹¤. ë­”ê°€ ì œëŒ€ë¡œ ì„¤ì¹˜ê°€ ì•ˆë˜ì–´ì„œ ì°¾ì•„ë³´ë‹ˆ Hyper-V í•˜ìœ„ì—ì„œ Hyper-Ví”Œë«í¼ì´ íšŒìƒ‰ìœ¼ë¡œ ë˜ì–´ìˆì—ˆë‹¤. (ë‚´ê°€ ì„¤ì •í•  ìˆ˜ ì—†ë‹¤ë¼ëŠ” ì˜ë¯¸ ê°™ì•˜ë‹¤.)

2. WSL2ì„¤ì¹˜

```
wsl --install

dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart

wsl --update
```

í•´ë‹¹ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í–ˆìœ¼ë‚˜

```
wsl --update
```
ì˜¤ë¥˜ì…ë‹ˆë‹¤!!!!!!

![image](https://github.com/HaejungHan/HaejungHan.github.io/assets/130989670/ab41cc64-b050-40ec-993b-7f57c39739f0)

ì°¾ì•„ë³´ë‹ˆ --web-downloadë¥¼ ë¶™ì—¬ì¤˜ì•¼ í•œë‹¤ëŠ”ê²ƒ?ì„ ì•Œê²Œë˜ì—ˆê³ ,
ê·¸ë˜ë„ ì„¤ì¹˜ê°€ ì›í™œíˆ ë˜ì§€ ì•Šì•„ ë” ì°¾ì•„ë³´ë‹ˆ

ì‘ì—…ê´€ë¦¬ì -> ì„±ëŠ¥ -> ê°€ìƒí™” : ì‚¬ìš©ì•ˆí•¨ì´ë¼ê³  ì„¤ì •ë˜ì–´ìˆì—ˆìŒ

CPU ê°€ìƒí™”ë¥¼ í™œì„±í™” ì‹œì¼œì£¼ì–´ì•¼ í–ˆëŠ”ë°, ì´ëŠ” ë°”ì´ì˜¤ìŠ¤ì— ì§„ì…í•´ì„œ ì„¤ì •ì„ í•´ì£¼ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤.

```
**ë°”ì´ì˜¤ìŠ¤: ì‚¬ìš©ìê°€ PCë¥¼ ì¼œë©´ ì‹œì‘ë˜ëŠ” í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì»´í“¨í„°ì˜ ì…ì¶œë ¥ì„ ì²˜ë¦¬í•˜ëŠ” íŒì›¨ì–´
```

ì•„ë˜ ë§í¬ë¥¼ ì°¸ê³ í•˜ì—¬ SVM Mode -> Enabledë¡œ ë³€ê²½í–ˆë‹¤.
ã…
ì œì¡°ì‚¬ ë§ˆë‹¤ advancdeModeê°€ ë‹¬ë¼ ì²˜ìŒì—ëŠ” ë‹¹í™©í–ˆìœ¼ë‚˜ ì–´ì°Œì €ì°Œ ì°¾ë‹¤ë³´ë©´.. ë‚˜ì˜¤ë”ë¼ ë‚˜ëŠ” advancedì—ì„œ CPUì–´ì©Œê³ ì €ì©Œê³ ê°€ ìˆì–´ì„œ ë“¤ì–´ê°€ë³´ë‹ˆ SVM modeê°€ disabledë¡œ ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸!
ê·¸ë¦¬ê³  ë³€ê²½í•´ì£¼ì—ˆë‹¤. 

[CPU ê°€ìƒí™” í™œì„±í™” ë°©ë²•](https://jih0.medium.com/amd-cpu-%EA%B0%80%EC%83%81%ED%99%94-%EB%B0%8F-windows-10-wsl-2-docker-desktop-%EC%84%A4%EC%B9%98-beb2b7a09397)

ê·¸ë¦¬ê³  ë‹¤ì‹œ ì‘ì—…ê´€ë¦¬ìì— ë“¤ì–´ê°€ì„œ í™•ì¸í•´ë³´ë‹ˆ 

![image](https://github.com/HaejungHan/HaejungHan.github.io/assets/130989670/bd1353ac-a94a-406c-aa90-1d79b9c4415f)

ìš”ë ‡ê²Œ ë³€ê²½ë˜ì–´ìˆìŒì„ í™•ì¸í–ˆë‹¤!!!!!

ë‹¤ì‹œ powershellë¡œ ë“¤ì–´ê°€ì„œ

```
wsl --install--web-download-d Ubuntu
```

ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆë‹¤!

![image](https://github.com/HaejungHan/HaejungHan.github.io/assets/130989670/ddcfe94d-f946-4315-b5ed-256376e03175)

ê·¸ë¦¬ê³  ì•„ë˜ ìˆœì„œì— ë”°ë¼ ëª…ë ¹ì–´ë¥¼ ì¹˜ê³  ë‹¤ìš´ë¡œë“œë¥¼ ì§„í–‰í•˜ë©´ ëœë‹¤!

```

# docker engine gpg í‚¤ ë“±ë¡
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.gpg

# apt source ì— docker ê´€ë ¨ ì¶”ê°€
echo \
  "deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  "$(. /etc/os-release && echo "$VERSION_CODENAME")" stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update

# docker engine ì„¤ì¹˜
sudo apt-get install -y docker-ce docker-ce-cli containerd.io \
docker-buildx-plugin docker-compose-plugin docker-compose

# docker ê·¸ë£¹ì— í˜„ì¬ ê³„ì •ì„ ë“±ë¡í•˜ì—¬ sudo ì—†ì´ docker ëª…ë ¹ì„ ì‚¬ìš©í•˜ê²Œ í•¨
sudo usermod -aG docker user
sudo service docker restart

# ìƒˆë¡œìš´ í„°ë¯¸ë„ì„ ì—´ê³  í™•ì¸
docker version

```

```
# docker version í™•ì¸
docker --version

# docker compose version í™•ì¸
docker-compose --version
```

ì´ì œ docker desktop ì„¤ì¹˜í•˜ëŸ¬ ê°€ì•¼ì§€!