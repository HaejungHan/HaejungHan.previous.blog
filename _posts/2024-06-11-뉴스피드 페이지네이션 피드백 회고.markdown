---
layout: post
title:  "TIL(20240611) [ë‰´ìŠ¤í”¼ë“œí”„ë¡œì íŠ¸: í˜ì´ì§€ë„¤ì´ì…˜ Pageable]"
date:  2024-06-11
categories: TIL Spring
---

---------------------------------------------------------------------


# ğŸ“Œ Spring


## ğŸ’¡ ë‰´ìŠ¤í”¼ë“œ í”„ë¡œì íŠ¸ : í˜ì´ì§€ë„¤ì´ì…˜ Pageable

- **í˜ì´ì§€ë„¤ì´ì…˜**
    - 10ê°œì”© í˜ì´ì§€ë„¤ì´ì…˜í•˜ì—¬, ê° í˜ì´ì§€ ë‹¹ ë‰´ìŠ¤í”¼ë“œ ë°ì´í„°ê°€ 10ê°œì”© ë‚˜ì˜¤ê²Œ í•©ë‹ˆë‹¤.
- **ì •ë ¬ ê¸°ëŠ¥**
    - ìƒì„±ì¼ì ê¸°ì¤€ ìµœì‹ ìˆœ
    - ì¢‹ì•„ìš” ë§ì€ ìˆœ
- **ê¸°ê°„ë³„ ê²€ìƒ‰ ê¸°ëŠ¥**
    - ì˜ˆ) 2024.05.01 ~ 2024.05.27 ë™ì•ˆ ì‘ì„±ëœ ë‰´ìŠ¤í”¼ë“œ ê²Œì‹œë¬¼ ê²€ìƒ‰

ì‚¬ì‹¤ í”„ë¡œì íŠ¸ ë°œí‘œì™€ ë§ˆê°ì œì¶œê¹Œì§€ ì™„ë£Œí•œ ìƒíƒœë¼ êµ¬ì§€ í•  í•„ìš”ëŠ” ì—†ì—ˆì§€ë§Œ í•œë²ˆ ë„ì „ì„ í•´ë³´ê³  ì‹¶ì–´ì„œ êµ¬í˜„í•´ë³´ì•˜ë‹¤.

ë¸”ë¡œê·¸ì—ì„œ ê°„ë‹¨í•˜ê²Œ í•˜ëŠ” ë°©ì‹ì´ ìˆì–´ì„œ í•œë²ˆ ë”°ë¼í•´ë³´ì•˜ëŠ”ë°,
êµ¬í˜„í•˜ê³  ë³´ë‹ˆ.. ë¬¸ì œê°€ ìˆì—ˆë‹¤. 

```java
// PostController


  // ìƒì„±ì¼ì ìµœì‹ ìˆœ í˜ì´ì§•ì²˜ë¦¬
  @GetMapping("/posts/paging")
  public Page<PostResponseDto> getPostAll(
      @PageableDefault(size = 10, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {
    return postService.getPostAll(pageable);
  }

  // ì¢‹ì•„ìš” ìµœì‹ ìˆœ í˜ì´ì§• ì²˜ë¦¬
  @GetMapping("/posts/bylikescount/paging")
  public Page<PostResponseDto> getPostByLikesCount(
      @PageableDefault(size = 10, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {
    return postService.getPostsByPostLikesCount(pageable);
  }

  // ê¸°ê°„ë³„ ê²€ìƒ‰ í˜ì´ì§• ì²˜ë¦¬
  @GetMapping("/posts/search/{start}/{end}")
  public Page<PostResponseDto> searchPost(
      @PathVariable LocalDate start,
      @PathVariable LocalDate end,
      @PageableDefault(size = 10, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {
    LocalDateTime startDate = start.atStartOfDay(); // LocalDate -> LocalDateTime ë³€í™˜
    LocalDateTime endDate = end.atTime(23, 59, 59);
    return postService.searchPost(startDate, endDate, pageable);
  }

```

```java

// PostService

  // ìƒì„±ì¼ì ìµœì‹ ìˆœ ì •ë ¬ í˜ì´ì§• ì²˜ë¦¬
  @Transactional(readOnly = true)
  public Page<PostResponseDto> getPostAll(
      @PageableDefault(size = 10, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {
    Page<Post> posts = postRepository.findAllByOrderByCreatedAtDesc(pageable);
    return posts.map(PostResponseDto::fromEntity);
  }

  // ì¢‹ì•„ìš” ë§ì€ìˆœ ì •ë ¬ í˜ì´ì§• ì²˜ë¦¬
  @Transactional(readOnly = true)
  public Page<PostResponseDto> getPostsByPostLikesCount(
      @PageableDefault(size = 10, sort = "id", direction = Sort.Direction.DESC) Pageable pageable) {
    Page<Post> postsByPostCountLikes = postRepository.findAllByOrderByPostLikesCountDesc(pageable);
    return postsByPostCountLikes.map(PostResponseDto::fromEntity);
  }

  // ê¸°ê°„ë³„ ê²€ìƒ‰ ë° í˜ì´ì§•
  @Transactional(readOnly = true)
  public Page<PostResponseDto> searchPost(LocalDateTime start, LocalDateTime end,
      Pageable pageable) {
    Page<Post> searchedPosts = postRepository.findByCreatedAtBetween(start, end, pageable);
    return searchedPosts.map(PostResponseDto::fromEntity);
  }

```

```java

// PostRepository

public interface PostRepository extends JpaRepository<Post, Long> {

  Page<Post> findAllByOrderByCreatedAtDesc(Pageable pageable);

  Page<Post> findByCreatedAtBetween(LocalDateTime start, LocalDateTime end, Pageable pageable);

  Page<Post> findAllByOrderByPostLikesCountDesc(Pageable pageable);


}


```

```java

// PostResponseDto

  public static PostResponseDto fromEntity(Post post) {
    PostResponseDto postResponseDto = new PostResponseDto();
    postResponseDto.postId = post.getId();
    postResponseDto.userId = post.getUser().getId();
    postResponseDto.title = post.getTitle();
    postResponseDto.contents = post.getContents();
    postResponseDto.createAt = post.getCreatedAt();
    postResponseDto.modifiedAt = post.getModifiedAt();
    postResponseDto.postLikesCount = post.getPostLikesCount();

    return postResponseDto;
  }

```


ë°˜í™˜íƒ€ì…ì„ Postì—ì„œ -> PostResponseDtoìœ¼ë¡œ ë°”ê¿”ì£¼ê¸° ìœ„í•´ í•´ë‹¹ ë‚´ìš©ì„ ì¶”ê°€í–ˆê³ , PostEntityì—ì„œëŠ” ìƒì„±ì¼ìë‚˜ ìˆ˜ì •ì¼ì ê°™ì€ ê²½ìš°ì—ëŠ” timestampë¡œ LocalDateTime í˜•íƒœë¡œ ì €ì¥ì´ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ì…ë ¥ê°’ì„ Pathvariableë¡œ LocalDateë¡œ ë°›ì•„ì„œ LocalDateTimeí˜•íƒœë¡œ í˜•ë³€í™˜ í•´ì¤€ í›„ repositoryì—ì„œ
DBë‚´ìš©ì„ ì°¾ì„ ìˆ˜ ìˆë„ë¡ í•´ì•¼í–ˆë‹¤. ìƒì„±ì¼ì ìµœì‹ ìˆœ Page<Post> findAllByOrderByCreatedAtDesc(Pageable pageable); ë¶€ë¶„ì„ êµ¬í˜„ í›„ì—ëŠ” ì¢‹ì•„ìš” ë§ì€ìˆœ êµ¬í˜„ì€ ê¸ˆë°© ê°ì„ ì¡ì•˜ë˜ ê²ƒ ê°™ë‹¤. ì•„ì§ê¹Œì§„ SQL ì¿¼ë¦¬ë¬¸ì— ëŒ€í•œ ì´í•´ë„ê°€ ë¶€ì¡±í•´ì„œ ì¡°ê¸ˆ ë” ê¹Šì´ìˆê²Œ ê³µë¶€ë¥¼ í•˜ë©´ JpaRepositoryì—ì„œ SQLì¿¼ë¦¬ë¬¸ì„ í™œìš©í•˜ì—¬ ì°¾ìœ¼ë ¤ê³  í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•œ ì •í™•í•œ ì´í•´ê°€ ìƒê¸¸ ê²ƒ ê°™ë‹¤. 

í•´ë‹¹ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ì•„ë˜ ë¸”ë¡œê·¸ë¥¼ ì°¸ê³  í–ˆìŠµë‹ˆë‹¤. 


[ìŠ¤í”„ë§ë¶€íŠ¸ ê²€ìƒ‰,í˜ì´ì§•ì²˜ë¦¬](https://gonyda.tistory.com/15)



## ğŸ ë‰´ìŠ¤í”¼ë“œ í”„ë¡œì íŠ¸ í”¼ë“œë°±



ğŸ”… ì˜í•œ  ì 
- ìŠ¤ì›¨ê±° ì ìš©
- ê¸°ìˆ  ìŠ¤íƒ ì‘ì„±í•œ ê²ƒ
- ë¦¬ë“œë¯¸ ê¹”ë”í•˜ê²Œ ì‘ì„±í•œ ê²ƒ
- ê¹ƒí—ˆë¸Œ Git Flow ì „ëµ ì‚¬ìš©í•œ ê²ƒ
- ì½”ë“œë¦¬ë·°í•˜ë©° íŒ€ì›ë“¤ê°„ì˜ ì˜ì‚¬ì†Œí†µí•œ ê²ƒ (ì¸ìƒê¹Šì—ˆë‹¤í•˜ì‹¬)



âœ” ì•„ì‰¬ìš´ ì 
- Response header ì‘ì„± (ì´ ë¶€ë¶„ì€ íŒ€ì› ì¤‘ í•œ ë¶„ì´ ì‘ì„±í•˜ì…¨ë‹¤ê°€ ì§€ìš°ì…¨ë‹¤ê³  í•œë‹¤..ğŸ˜‚)




ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ì„œ ì •ë§ ëŠë‚€ ê²ƒë“¤ì´ ë§ì•˜ë‹¤.
ì´ˆê¸°ì„¸íŒ… ë° ê¸°íšì„¤ê³„ê°€ ì •ë§ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í–ˆê³ ,
    1)ì´ˆê¸°ì„¸íŒ… : ì½”ë“œì»¨ë²¤ì…˜ì— ëŒ€í•œ ê³µë¶€ê°€ í•„ìš” ì½”ë“œëª…ì— ëŒ€í•œ ë¶ˆì¼ì¹˜, ë¶ˆëª…í™•ì„± .. ë“±ë“± 
    2)ê¸°íšì„¤ê³„ : ê°ìì˜ í•´ì„ì— ë”°ë¼ êµ¬í˜„ì„ í•´ì„œ ë‚˜ì¤‘ì— ì˜ê²¬ì´ ë‹¬ë¼ì„œ ì¬êµ¬í˜„í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ë°œìƒ
ë‹¤ìŒ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê¸°íšì„¤ê³„ ë¶€ë¶„ì— ì‹ ê²½ì„ ë§ì´ ì¨ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤. ê·¸ë¦¬ê³  í…Œë§ˆ(ì£¼ì œ)ë¥¼ ì •í–ˆì§€ë§Œ ì˜ë„ëŒ€ë¡œëŠ” êµ¬í˜„ì´ ë˜ì§€ ì•Šì€ ë“¯í•œ ëŠë‚Œ.. ì‚¬ì‹¤ ê¸°ëŠ¥ êµ¬í˜„ì´ ì„œíˆ´ë‹¤ ë³´ë‹ˆ ì´ëŸ° ë¶€ë¶„ì„ ë§ì´ ë†“ì³¤ë˜ ê²ƒ ê°™ë‹¤. ê°œì¸ì ìœ¼ë¡œ ê¸°ëŠ¥ êµ¬í˜„ë¶€ë¶„ì—ì„œëŠ” ì´ë©”ì¼ ì¸ì¦ ë¶€ë¶„ì—ì„œ ë§ì´ ì•„ì‰¬ì› ë‹¤...ë‹¤ìŒ ë²ˆì—ëŠ” ë” ê³µë¶€ë¥¼ í•´ì„œ ë©‹ì§€ê²Œ êµ¬í˜„í•´ë³´ê³ ì‹¶ë‹¤! (ìµœì¢…í”„ë¡œì íŠ¸ì—...?ã…ã…;;;)


ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ì„œ ì•„ì‰¬ì›€ë„ ë§ì´ ë‚¨ê¸°ë„ í•˜ì§€ë§Œ ì •ë§ ë§ì´ ë°°ìš°ê³ , ê¹¨ë‹«ì„ ìˆ˜ ìˆëŠ” ê³„ê¸°ê°€ ìƒê²¨ì„œ ì¢‹ì•˜ê³  íŒ€ì›ë“¤ì´ë‘ íŠ¸ëŸ¬ë¸” ì—†ì´ ìˆœì¡°ë¡­ê²Œ ì˜ ì§„í–‰ë˜ì–´ì„œ ì •ë§ ê°ì‚¬í•˜ê²Œ ìƒê°í•œë‹¤.
ë‹¤ìŒ í”„ë¡œì íŠ¸ì—ë„ ëª¨ë‘ë“¤ í™”ì´íŒ…!!!! ğŸ¥°



---------------------------------------------------------------------







